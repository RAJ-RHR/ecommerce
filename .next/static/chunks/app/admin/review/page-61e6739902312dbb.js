(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[403],{1373:function(e,t,a){Promise.resolve().then(a.bind(a,842))},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},5523:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return s}});let s=a(7043)._(a(2265)).default.createContext(null)},842:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var s=a(7437),n=a(2265),r=a(5978),l=a(6410),i=a(9376),d=a(3145);function o(){var e;let t=(0,i.useRouter)(),[a,o]=(0,n.useState)(!1),[c,u]=(0,n.useState)([]),[m,g]=(0,n.useState)([]),[x,h]=(0,n.useState)("pending"),[b,p]=(0,n.useState)(""),[v,f]=(0,n.useState)([0,5]),[j,N]=(0,n.useState)("date"),[w,y]=(0,n.useState)(""),[S,C]=(0,n.useState)(1),[D,k]=(0,n.useState)(null);(0,n.useEffect)(()=>{"true"===localStorage.getItem("admin")?(o(!0),P()):t.push("/admin/login")},[t]);let P=async()=>{let[e,t]=await Promise.all([(0,r.PL)((0,r.hJ)(l.db,"reviews")),(0,r.PL)((0,r.hJ)(l.db,"products"))]),a=t.docs.map(e=>({id:e.id,...e.data()})),s=e.docs.map(e=>{var t,a;let s=e.data();return{id:e.id,...s,createdAt:(null===(a=s.created_at)||void 0===a?void 0:null===(t=a.toDate)||void 0===t?void 0:t.call(a))||null}});g(a),u(s)},O=e=>m.find(t=>t.id===e.productId)||{},A=async e=>{await (0,r.r7)((0,r.JU)(l.db,"reviews",e),{status:"approved"}),P()},I=async e=>{confirm("Delete this review?")&&(await (0,r.oe)((0,r.JU)(l.db,"reviews",e)),P())},R=async()=>{if(!D)return;let e=null;try{var t;if(D.dateOfSubmit instanceof Date)e=D.dateOfSubmit;else if(null===(t=D.dateOfSubmit)||void 0===t?void 0:t.seconds)e=new Date(1e3*D.dateOfSubmit.seconds);else{let t=new Date(D.dateOfSubmit);e=isNaN(t.getTime())?null:t}}catch(t){e=null}await (0,r.r7)((0,r.JU)(l.db,"reviews",D.id),{name:D.name,message:D.message,rating:D.rating,status:D.status,...e&&{dateOfSubmit:e}}),k(null),P()},_=c.filter(e=>e.status===x).filter(e=>{var t,a;let s=O(e);return(!b||s.category===b)&&e.rating>=v[0]&&e.rating<=v[1]&&((null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(w.toLowerCase()))||(null===(a=s.name)||void 0===a?void 0:a.toLowerCase().includes(w.toLowerCase())))}).sort((e,t)=>{var a,s;return"date"===j?((null===(a=t.createdAt)||void 0===a?void 0:a.getTime())||0)-((null===(s=e.createdAt)||void 0===s?void 0:s.getTime())||0):t.rating-e.rating}),E=_.slice((S-1)*40,40*S);return a?(0,s.jsxs)("div",{className:"mt-20 max-w-6xl mx-auto p-4",children:[(0,s.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:()=>t.push("/admin"),className:"bg-gray-700 text-white px-2 py-2 rounded hover:bg-gray-800",children:"← Go to Home"}),(0,s.jsx)("h2",{className:"text-2xl font-bold ml-2",children:"\uD83D\uDCDD Review Moderation"})]}),(0,s.jsx)("div",{className:"flex gap-4 mb-4 border-b border-gray-200",children:["pending","approved","rejected"].map(e=>{let t=c.filter(t=>t.status===e).length;return(0,s.jsxs)("button",{onClick:()=>h(e),className:"py-2 px-4 capitalize font-medium transition border-b-2 flex items-center gap-1 ".concat(x===e?"border-green-600 text-green-600":"border-transparent text-gray-500 hover:text-green-600"),children:[e," ",(0,s.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:t})]},e)})}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-3 mb-4 items-center",children:[(0,s.jsxs)("select",{value:b,onChange:e=>p(e.target.value),className:"border p-2 rounded",children:[(0,s.jsx)("option",{value:"",children:"All Categories"}),["Weight Management","Enhancers","Energy & Fitness","Children's Health","Women's Health","Men's Health","Bone & Joint Health","Digestive Health","Sports Nutritions","Skin & Body Care","Male Enhancement"].map(e=>(0,s.jsx)("option",{children:e},e))]}),(0,s.jsx)("input",{type:"text",placeholder:"\uD83D\uDD0E Search name/product",value:w,onChange:e=>y(e.target.value),className:"border p-2 rounded w-64"}),(0,s.jsxs)("select",{value:j,onChange:e=>N(e.target.value),className:"border p-2 rounded",children:[(0,s.jsx)("option",{value:"date",children:"Sort by Date"}),(0,s.jsx)("option",{value:"rating",children:"Sort by Rating"})]})]}),(0,s.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(e=>{var t;let a=O(e);return(0,s.jsxs)("div",{className:"border rounded p-3 bg-white shadow relative",children:[a.image&&(0,s.jsx)(d.default,{src:a.image,alt:a.name,width:48,height:48,className:"absolute top-2 right-2 rounded",loading:"lazy"}),(0,s.jsxs)("p",{className:"font-semibold",children:[e.name," (","★".repeat(e.rating),"☆".repeat(5-e.rating),")"]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:(null===(t=e.createdAt)||void 0===t?void 0:t.toLocaleString())||"No Date"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["Product: ",a.name||"Unknown"]}),(0,s.jsx)("p",{className:"text-gray-700 text-sm",children:e.message}),(0,s.jsxs)("div",{className:"mt-3 flex gap-2",children:["pending"===e.status&&(0,s.jsx)("button",{onClick:()=>A(e.id),className:"text-sm px-2 py-1 bg-green-600 text-white rounded",children:"Approve"}),(0,s.jsx)("button",{onClick:()=>I(e.id),className:"text-sm px-2 py-1 bg-red-600 text-white rounded",children:"Delete"}),(0,s.jsx)("button",{onClick:()=>k(e),className:"text-sm px-2 py-1 bg-blue-600 text-white rounded",children:"Edit"})]})]},e.id)})}),(0,s.jsx)("div",{className:"mt-6 flex justify-center gap-2",children:Array.from({length:Math.ceil(_.length/40)},(e,t)=>(0,s.jsx)("button",{onClick:()=>C(t+1),className:"px-3 py-1 border rounded ".concat(S===t+1?"bg-blue-600 text-white":"bg-white"),children:t+1},t))}),D&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/30 z-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded max-w-md w-full",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-500 mb-1",children:["Created At: ",null===(e=D.createdAt)||void 0===e?void 0:e.toLocaleString()]}),(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Submit:"}),(0,s.jsx)("input",{type:"date",className:"border w-full p-2 mb-4",value:(()=>{try{var e;if(null===(e=D.dateOfSubmit)||void 0===e?void 0:e.seconds)return new Date(1e3*D.dateOfSubmit.seconds).toISOString().slice(0,10);let t=new Date(D.dateOfSubmit);return isNaN(t.getTime())?"":t.toISOString().slice(0,10)}catch(e){return""}})(),onChange:e=>{let t=new Date(e.target.value);t.setHours(0,0,0,0),k({...D,dateOfSubmit:t})}}),(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Name"}),(0,s.jsx)("input",{className:"border p-2 w-full mb-3",value:D.name,onChange:e=>k({...D,name:e.target.value})}),(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Message"}),(0,s.jsx)("textarea",{className:"border p-2 w-full mb-3",value:D.message,onChange:e=>k({...D,message:e.target.value})}),(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Rating"}),(0,s.jsx)("div",{className:"flex gap-1 mb-3",children:Array.from({length:5}).map((e,t)=>(0,s.jsx)("button",{onClick:()=>k({...D,rating:t+1}),className:"text-xl ".concat(t<D.rating?"text-yellow-500":"text-gray-300"),children:"★"},t))}),(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Status"}),(0,s.jsxs)("select",{value:D.status,onChange:e=>k({...D,status:e.target.value}),className:"border p-2 w-full mb-4",children:[(0,s.jsx)("option",{value:"pending",children:"Pending"}),(0,s.jsx)("option",{value:"approved",children:"Approved"}),(0,s.jsx)("option",{value:"rejected",children:"Rejected"})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>k(null),className:"px-4 py-2 border rounded",children:"Cancel"}),(0,s.jsx)("button",{onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Save"})]})]})})]}):null}},6410:function(e,t,a){"use strict";a.d(t,{I:function(){return d},db:function(){return i}});var s=a(738),n=a(5978),r=a(3301);let l=(0,s.ZF)({apiKey:"AIzaSyAI8stgPus8Q8J-w7drj-JddmaKo6Z0hRs",authDomain:"herbolife-store.firebaseapp.com",projectId:"herbolife-store",storageBucket:"herbolife-store.firebasestorage.app",messagingSenderId:"922872122127",appId:"1:922872122127:web:001b4377661261b9cc4c7a"}),i=(0,n.ad)(l),d=(0,r.v0)(l)}},function(e){e.O(0,[358,728,943,145,971,117,744],function(){return e(e.s=1373)}),_N_E=e.O()}]);